---
title: 99_付録（スキーマ / 例 / 参照）
status: draft-2
last_updated: 2025-09-05
---

# A. JSON スキーマ（概念定義）

リクエスト（概念）

```json
{
  "type": "object",
  "properties": {
    "method": {"type":"string"},
    "params": {"type":"object"}
  },
  "required": ["method"]
}
```

レスポンス（概念）

```json
{
  "type": "object",
  "properties": {
    "ok": {"type":"boolean"},
    "data": {},
    "error": {"type":["object","null"]},
    "logs": {"type":["array","null"]},
    "meta": {"type":["object","null"]}
  },
  "required": ["ok"]
}
```

# B. 代表的な cURL 例

- getContent

```bash
curl -H "Content-Type: application/json" -X POST \
  -d '{"method":"getContent","params":{"scriptId":"YOUR_SCRIPT_ID"}}' \
  "https://script.google.com/macros/s/AKfy.../exec"
```

- updateContent（HTML 同梱）

```bash
curl -H "Content-Type: application/json" -X POST \
  -d '{
    "method":"updateContent",
    "params":{
      "scriptId":"YOUR_SCRIPT_ID",
      "files":[
        {"name":"Index","type":"HTML","source":"<!doctype html><html><body><?= name ?></body></html>"},
        {"name":"Code","type":"SERVER_JS","source":"function doGet(){ const t=HtmlService.createTemplateFromFile(\"Index\"); t.name=\"World\"; return t.evaluate(); }"},
        {"name":"appsscript","type":"JSON","source":"{ \"timeZone\":\"Asia/Tokyo\" }"}
      ]
    }
  }' \
  "https://script.google.com/macros/s/AKfy.../exec"
```

- run（ログ/エラー取得）

```bash
curl -H "Content-Type: application/json" -X POST \
  -d '{"method":"run","params":{"scriptId":"YOUR_SCRIPT_ID","functionName":"main","parameters":[],"devMode":true}}' \
"https://script.google.com/macros/s/AKfy.../exec"
```

- listVersions（バージョン一覧）

```bash
curl -H "Content-Type: application/json" -X POST \
  -d '{"method":"listVersions","params":{"scriptId":"YOUR_SCRIPT_ID"}}' \
  "https://script.google.com/macros/s/AKfy.../exec"
```

- ensureAdminShim（未導入なら注入）

```bash
curl -H "Content-Type: application/json" -X POST \
  -d '{"method":"ensureAdminShim","params":{"scriptId":"YOUR_SCRIPT_ID"}}' \
  "https://script.google.com/macros/s/AKfy.../exec"
```

# C. スコープ/デプロイ設定（再掲）

`appsscript.json`

```json
{
  "timeZone": "Asia/Tokyo",
  "exceptionLogging": "STACKDRIVER",
  "oauthScopes": [
    "https://www.googleapis.com/auth/script.projects",
    "https://www.googleapis.com/auth/script.deployments",
    "https://www.googleapis.com/auth/script.scriptapp",
    "https://www.googleapis.com/auth/script.external_request",
    "https://www.googleapis.com/auth/drive.readonly"
  ]
}
```

デプロイ設定（例）

- A案: 実行者=アクセスしているユーザー、アクセス=Google アカウントを持つ全員
- B案: 実行者=自分、アクセス=全員（リンク）＋X-Admin-Token/Allowlist を doPost に実装

# D. CLI マッピング（gas-admin 互換の例）

- `whoami` → `ping`
- `get` → `getContent`
- `update` → `updateContent`
- `run` → `run(devMode:true)`
- `version` → `createVersion`
- `deploy` → `createDeployment`
- `depl:list` → `listDeployments`
- `depl:update` → `updateDeployment`
- `versions:list` → `listVersions`
- `trig:list|add|del` → AdminShim 経由
- `prop:list|set|del` → AdminShim 経由
